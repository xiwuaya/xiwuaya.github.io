<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>解决hashcat -m 2500报错，Hccapx格式转换为Hc22000 | End</title>
<meta name=keywords content><meta name=description content="hashcat官方从 6.0.0 版本开始，不再接受2500的哈希模式，转为接受新的哈希模式 22000
如果仍旧使用-m 2500则会遇到报错
The plugin 2500 is deprecated and was replaced with plugin 22000. For more details, please read: https://hashcat.net/forum/thread-10253.html
解决方法之一就是将不再受支持的hccapx格式转换为hc22000格式"><meta name=author content><link rel=canonical href=https://blog.badend.cn/post/hccapx-to-hc22000/><link crossorigin=anonymous href=/assets/css/stylesheet.d72444526d7ecbdb0015438a7fa89054a658bf759d0542e2e5df81ce94b493ee.css integrity="sha256-1yREUm1+y9sAFUOKf6iQVKZYv3WdBULi5d+BzpS0k+4=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.badend.cn/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.badend.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.badend.cn/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.badend.cn/apple-touch-icon.png><link rel=mask-icon href=https://blog.badend.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.badend.cn/post/hccapx-to-hc22000/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://blog.badend.cn/post/hccapx-to-hc22000/"><meta property="og:site_name" content="End"><meta property="og:title" content="解决hashcat -m 2500报错，Hccapx格式转换为Hc22000"><meta property="og:description" content="hashcat官方从 6.0.0 版本开始，不再接受2500的哈希模式，转为接受新的哈希模式 22000
如果仍旧使用-m 2500则会遇到报错
The plugin 2500 is deprecated and was replaced with plugin 22000. For more details, please read: https://hashcat.net/forum/thread-10253.html 解决方法之一就是将不再受支持的hccapx格式转换为hc22000格式"><meta property="og:locale" content="zh-CN"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2025-01-11T22:18:52+08:00"><meta property="article:modified_time" content="2025-01-11T22:18:52+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="解决hashcat -m 2500报错，Hccapx格式转换为Hc22000"><meta name=twitter:description content="hashcat官方从 6.0.0 版本开始，不再接受2500的哈希模式，转为接受新的哈希模式 22000
如果仍旧使用-m 2500则会遇到报错
The plugin 2500 is deprecated and was replaced with plugin 22000. For more details, please read: https://hashcat.net/forum/thread-10253.html
解决方法之一就是将不再受支持的hccapx格式转换为hc22000格式"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.badend.cn/post/"},{"@type":"ListItem","position":2,"name":"解决hashcat -m 2500报错，Hccapx格式转换为Hc22000","item":"https://blog.badend.cn/post/hccapx-to-hc22000/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"解决hashcat -m 2500报错，Hccapx格式转换为Hc22000","name":"解决hashcat -m 2500报错，Hccapx格式转换为Hc22000","description":"hashcat官方从 6.0.0 版本开始，不再接受2500的哈希模式，转为接受新的哈希模式 22000\n如果仍旧使用-m 2500则会遇到报错\nThe plugin 2500 is deprecated and was replaced with plugin 22000. For more details, please read: https://hashcat.net/forum/thread-10253.html 解决方法之一就是将不再受支持的hccapx格式转换为hc22000格式\n","keywords":[],"articleBody":"hashcat官方从 6.0.0 版本开始，不再接受2500的哈希模式，转为接受新的哈希模式 22000\n如果仍旧使用-m 2500则会遇到报错\nThe plugin 2500 is deprecated and was replaced with plugin 22000. For more details, please read: https://hashcat.net/forum/thread-10253.html 解决方法之一就是将不再受支持的hccapx格式转换为hc22000格式\nhccapx的结构\n用16进制编辑器打开可以看到\nhc22000的结构\n本质上是将原本hccapx格式中的字段重新排列，然后以文本形式而非16进制呈现\n重新排列的顺序为\nPROTOCOL*TYPE*PMKID/MIC*MACAP*MACCLIENT*ESSID*ANONCE*EAPOL*MESSAGEPAIR\n下面一个将2500模式下hccapx格式转为最新的hc2200的小程序，源码来自sleshep\nimport sys import os import struct def main(): if len(sys.argv) != 2: print(\"Usage: python convert_hccapx_to_22000.py \") sys.exit(1) input_file = sys.argv[1] if not os.path.isfile(input_file): print(f\"Error: File '{input_file}' does not exist.\") sys.exit(1) with open(input_file, \"rb\") as f: data = f.read() def get_data(fmt, data): result = struct.unpack(fmt, data) # unpack the (som,) to som if isinstance(result, tuple) and len(result) == 1: result = result[0] return result \"\"\" Field name\tOffsets (hex)\tOffsets (dec)\tField description signature\t0x00 to 0x03\t0 to 3\tthe signature (file magic) of .hccapx files, it is always the string HCPX version\t0x04 to 0x07\t4 to 7\tthe version number of the .hccapx file format message_pair\t0x08\t8\tpossible values range from 0 to 5 or 128 to 133 (see message_pair table below) 1 essid_len\t0x09\t9\tthe length of the network name (ESSID) essid\t0x0a to 0x29\t10 to 41\tthe network name (ESSID) keyver\t0x2a\t42\tset to 1 if WPA is used, other values (preferably 2) means WPA2 keymic\t0x2b to 0x3a\t43 to 58\tthe actual hash value (MD5 for WPA, SHA1 for WPA2) truncated to 128 bit (16 bytes) mac_ap\t0x3b to 0x40\t59 to 64\tthe mac address of the access point (BSSID) nonce_ap\t0x41 to 0x60\t65 to 96\tnonce (random salt) generated by the access point mac_sta\t0x61 to 0x66\t97 to 102\tthe mac address of the client connecting to the access point nonce_sta\t0x67 to 0x86\t103 to 134\tnonce (random salt) generated by the client connecting to the access point eapol_len\t0x87 to 0x88\t135 to 136\tthe length of the EAPOL eapol\t0x89 to 0x188\t137 to 392\tthe EAPOL (max 256 bytes) \"\"\" signature: str = get_data('4s', data[0:4]) # type:ignore if signature != b'HCPX': print(f\"Error: Invalid hccapx file.signature is {signature}\") sys.exit(1) version: int = get_data('I', data[4:8]) # type:ignore message_pair: int = get_data('B', data[8:9]) # type:ignore essid_len: int = get_data('B', data[9:10]) # type:ignore essid: bytes = get_data( f'{essid_len}s', data[10:10+essid_len]) # type:ignore keyver: int = get_data('B', data[42:43]) # type:ignore keymic: bytes = get_data('16s', data[43:59]) # type:ignore mac_ap: bytes = get_data('6s', data[59:65]) # type:ignore nonce_ap: bytes = get_data('32s', data[65:97]) # type:ignore mac_sta: bytes = get_data('6s', data[97:103]) # type:ignore nonce_sta: bytes = get_data('32s', data[103:135]) # type:ignore eapol_len: int = get_data('H', data[135:137]) # type:ignore eapol: bytes = get_data(f'{eapol_len}s', data[137:137+eapol_len]) # type:ignore \"\"\" For developers The new hash format 22000 in detail: Code: PROTOCOL*TYPE*PMKID/MIC*MACAP*MACCLIENT*ESSID*ANONCE*EAPOL*MESSAGEPAIR PROTOCOL = Fixed string \"WPA\" TYPE = 01 for PMKID, 02 for EAPOL PMKID/MIC = PMKID if TYPE=01, MIC if TYPE=02 MACAP = MAC of AP MACCLIENT = MAC of CLIENT ESSID = network name (ESSID) in HEX ANONCE = ANONCE EAPOL = EAPOL (SNONCE is in here) MESSAGEPAIR = Bitmask: 0: MP info (https://hashcat.net/wiki/doku.php?id=hccapx) 1: MP info (https://hashcat.net/wiki/doku.php?id=hccapx) 2: MP info (https://hashcat.net/wiki/doku.php?id=hccapx) 3: x (unused) 4: ap-less attack (set to 1) - no nonce-error-corrections necessary 5: LE router detected (set to 1) - nonce-error-corrections only for LE necessary 6: BE router detected (set to 1) - nonce-error-corrections only for BE necessary 7: not replaycount checked (set to 1) - replaycount not checked, nonce-error-corrections definitely necessary \"\"\" # Construct hashcat 22000 format string protocol = \"WPA\" pmkid_mic = keymic.hex() type = \"02\" if keyver == 1: raise Exception(\"version 2 file not supported\") mac_ap_hex = mac_ap.hex() mac_client_hex = mac_sta.hex() essid_hex = essid.hex() nonce_ap_hex = nonce_ap.hex() eapol_hex = eapol.hex() message_pair_hex = f\"{message_pair:02x}\" hc22000 = f\"{protocol}*{type}*{pmkid_mic}*{mac_ap_hex}*{mac_client_hex}*{essid_hex}*{nonce_ap_hex}*{eapol_hex}*{message_pair_hex}\" print(hc22000) def change_extension(inputfile, new_extension=\".hc22000\"): \"\"\" 更改文件的后缀名 :param inputfile: 输入文件的路径 :param new_extension: 新的后缀名（例如 \".txt\", \".csv\"） :return: 返回新的文件名 \"\"\" # 获取文件名（不含路径）和目录 base_name = os.path.basename(inputfile) # 获取文件名（含后缀） dir_name = os.path.dirname(inputfile) # 获取目录路径 # 分离文件名和后缀 name, _ = os.path.splitext(base_name) # 分离文件名和后缀 # 构建新的文件名 new_filename = name + new_extension # 如果目录不为空，拼接目录和新的文件名 if dir_name: new_filepath = os.path.join(dir_name, new_filename) else: new_filepath = new_filename return new_filepath outputfile = change_extension(input_file) with open(outputfile, 'w') as outfile: outfile.writelines(hc22000) if __name__ == \"__main__\": main() 顺便附带两条常用的掩码模式破解语句\n8位小写字母\nhashcat -a 3 -m 22000 dNKc.hc22000 ?l?l?l?l?l?l?l?l -o dump.txt\n8位小写字母数字混合\nhashcat -a 3 -m 22000 dNKc.hc22000 -1 ?l?d ?1?1?1?1?1?1?1?1 -o dump.txt\nref : https://hashcat.net/wiki/doku.php?id=hccapx\nref : https://hashcat.net/wiki/doku.php?id=cracking_wpawpa2#expected_file_format\nref : https://hashcat.net/forum/thread-10253.html\nref : https://hashcat.net/forum/thread-11417.html\n","wordCount":"1036","inLanguage":"en","datePublished":"2025-01-11T22:18:52+08:00","dateModified":"2025-01-11T22:18:52+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.badend.cn/post/hccapx-to-hc22000/"},"publisher":{"@type":"Organization","name":"End","logo":{"@type":"ImageObject","url":"https://blog.badend.cn/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.badend.cn/ accesskey=h title="End (Alt + H)">End</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">解决hashcat -m 2500报错，Hccapx格式转换为Hc22000</h1><div class=post-meta><span title='2025-01-11 22:18:52 +0800 CST'>2025-01-11</span></div></header><div class=post-content><p>hashcat官方从 6.0.0 版本开始，不再接受2500的哈希模式，转为接受新的哈希模式 22000</p><p>如果仍旧使用-m 2500则会遇到报错</p><pre tabindex=0><code>The plugin 2500 is deprecated and was replaced with plugin 22000. For more details, please read: https://hashcat.net/forum/thread-10253.html
</code></pre><p>解决方法之一就是将不再受支持的hccapx格式转换为hc22000格式</p><p><strong>hccapx的结构</strong></p><p>用16进制编辑器打开可以看到<img alt=hccapx_specs loading=lazy src="https://hashcat.net/wiki/lib/exe/fetch.php?media=hccapx_specs.jpg"></p><p><strong>hc22000的结构</strong></p><p>本质上是将原本hccapx格式中的字段重新排列，然后以文本形式而非16进制呈现</p><p>重新排列的顺序为</p><p><code>PROTOCOL*TYPE*PMKID/MIC*MACAP*MACCLIENT*ESSID*ANONCE*EAPOL*MESSAGEPAIR</code></p><p>下面一个将2500模式下hccapx格式转为最新的hc2200的小程序，源码来自<a href=https://gist.github.com/sleshep/eba782703d3be4d95ba14765705f647d>sleshep</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> sys
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> struct
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(sys<span style=color:#f92672>.</span>argv) <span style=color:#f92672>!=</span> <span style=color:#ae81ff>2</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Usage: python convert_hccapx_to_22000.py &lt;input_hccapx_file&gt;&#34;</span>)
</span></span><span style=display:flex><span>        sys<span style=color:#f92672>.</span>exit(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    input_file <span style=color:#f92672>=</span> sys<span style=color:#f92672>.</span>argv[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>isfile(input_file):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Error: File &#39;</span><span style=color:#e6db74>{</span>input_file<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39; does not exist.&#34;</span>)
</span></span><span style=display:flex><span>        sys<span style=color:#f92672>.</span>exit(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(input_file, <span style=color:#e6db74>&#34;rb&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        data <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_data</span>(fmt, data):
</span></span><span style=display:flex><span>        result <span style=color:#f92672>=</span> struct<span style=color:#f92672>.</span>unpack(fmt, data)
</span></span><span style=display:flex><span>        <span style=color:#75715e># unpack the (som,) to som</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> isinstance(result, tuple) <span style=color:#f92672>and</span> len(result) <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>            result <span style=color:#f92672>=</span> result[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> result
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Field name	Offsets (hex)	Offsets (dec)	Field description
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    signature	0x00 to 0x03	0 to 3	the signature (file magic) of .hccapx files, it is always the string HCPX
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    version	0x04 to 0x07	4 to 7	the version number of the .hccapx file format
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    message_pair	0x08	8	possible values range from 0 to 5 or 128 to 133 (see message_pair table below) 1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    essid_len	0x09	9	the length of the network name (ESSID)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    essid	0x0a to 0x29	10 to 41	the network name (ESSID)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    keyver	0x2a	42	set to 1 if WPA is used, other values (preferably 2) means WPA2
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    keymic	0x2b to 0x3a	43 to 58	the actual hash value (MD5 for WPA, SHA1 for WPA2) truncated to 128 bit (16 bytes)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mac_ap	0x3b to 0x40	59 to 64	the mac address of the access point (BSSID)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    nonce_ap	0x41 to 0x60	65 to 96	nonce (random salt) generated by the access point
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    mac_sta	0x61 to 0x66	97 to 102	the mac address of the client connecting to the access point
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    nonce_sta	0x67 to 0x86	103 to 134	nonce (random salt) generated by the client connecting to the access point
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    eapol_len	0x87 to 0x88	135 to 136	the length of the EAPOL
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    eapol	0x89 to 0x188	137 to 392	the EAPOL (max 256 bytes)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    signature: str <span style=color:#f92672>=</span> get_data(<span style=color:#e6db74>&#39;4s&#39;</span>, data[<span style=color:#ae81ff>0</span>:<span style=color:#ae81ff>4</span>])  <span style=color:#75715e># type:ignore</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> signature <span style=color:#f92672>!=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;HCPX&#39;</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Error: Invalid hccapx file.signature is </span><span style=color:#e6db74>{</span>signature<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        sys<span style=color:#f92672>.</span>exit(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    version: int <span style=color:#f92672>=</span> get_data(<span style=color:#e6db74>&#39;I&#39;</span>, data[<span style=color:#ae81ff>4</span>:<span style=color:#ae81ff>8</span>])  <span style=color:#75715e># type:ignore</span>
</span></span><span style=display:flex><span>    message_pair: int <span style=color:#f92672>=</span> get_data(<span style=color:#e6db74>&#39;B&#39;</span>, data[<span style=color:#ae81ff>8</span>:<span style=color:#ae81ff>9</span>])  <span style=color:#75715e># type:ignore</span>
</span></span><span style=display:flex><span>    essid_len: int <span style=color:#f92672>=</span> get_data(<span style=color:#e6db74>&#39;B&#39;</span>, data[<span style=color:#ae81ff>9</span>:<span style=color:#ae81ff>10</span>])  <span style=color:#75715e># type:ignore</span>
</span></span><span style=display:flex><span>    essid: bytes <span style=color:#f92672>=</span> get_data(
</span></span><span style=display:flex><span>        <span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{</span>essid_len<span style=color:#e6db74>}</span><span style=color:#e6db74>s&#39;</span>, data[<span style=color:#ae81ff>10</span>:<span style=color:#ae81ff>10</span><span style=color:#f92672>+</span>essid_len])  <span style=color:#75715e># type:ignore</span>
</span></span><span style=display:flex><span>    keyver: int <span style=color:#f92672>=</span> get_data(<span style=color:#e6db74>&#39;B&#39;</span>, data[<span style=color:#ae81ff>42</span>:<span style=color:#ae81ff>43</span>])  <span style=color:#75715e># type:ignore</span>
</span></span><span style=display:flex><span>    keymic: bytes <span style=color:#f92672>=</span> get_data(<span style=color:#e6db74>&#39;16s&#39;</span>, data[<span style=color:#ae81ff>43</span>:<span style=color:#ae81ff>59</span>])  <span style=color:#75715e># type:ignore</span>
</span></span><span style=display:flex><span>    mac_ap: bytes <span style=color:#f92672>=</span> get_data(<span style=color:#e6db74>&#39;6s&#39;</span>, data[<span style=color:#ae81ff>59</span>:<span style=color:#ae81ff>65</span>])  <span style=color:#75715e># type:ignore</span>
</span></span><span style=display:flex><span>    nonce_ap: bytes <span style=color:#f92672>=</span> get_data(<span style=color:#e6db74>&#39;32s&#39;</span>, data[<span style=color:#ae81ff>65</span>:<span style=color:#ae81ff>97</span>])  <span style=color:#75715e># type:ignore</span>
</span></span><span style=display:flex><span>    mac_sta: bytes <span style=color:#f92672>=</span> get_data(<span style=color:#e6db74>&#39;6s&#39;</span>, data[<span style=color:#ae81ff>97</span>:<span style=color:#ae81ff>103</span>])  <span style=color:#75715e># type:ignore</span>
</span></span><span style=display:flex><span>    nonce_sta: bytes <span style=color:#f92672>=</span> get_data(<span style=color:#e6db74>&#39;32s&#39;</span>, data[<span style=color:#ae81ff>103</span>:<span style=color:#ae81ff>135</span>])  <span style=color:#75715e># type:ignore</span>
</span></span><span style=display:flex><span>    eapol_len: int <span style=color:#f92672>=</span> get_data(<span style=color:#e6db74>&#39;H&#39;</span>, data[<span style=color:#ae81ff>135</span>:<span style=color:#ae81ff>137</span>])  <span style=color:#75715e># type:ignore</span>
</span></span><span style=display:flex><span>    eapol: bytes <span style=color:#f92672>=</span> get_data(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{</span>eapol_len<span style=color:#e6db74>}</span><span style=color:#e6db74>s&#39;</span>, data[<span style=color:#ae81ff>137</span>:<span style=color:#ae81ff>137</span><span style=color:#f92672>+</span>eapol_len])  <span style=color:#75715e># type:ignore</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    For developers
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    The new hash format 22000 in detail:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Code:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    PROTOCOL*TYPE*PMKID/MIC*MACAP*MACCLIENT*ESSID*ANONCE*EAPOL*MESSAGEPAIR
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    PROTOCOL = Fixed string &#34;WPA&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    TYPE = 01 for PMKID, 02 for EAPOL
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    PMKID/MIC = PMKID if TYPE=01, MIC if TYPE=02
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    MACAP = MAC of AP
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    MACCLIENT = MAC of CLIENT
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    ESSID = network name (ESSID) in HEX
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    ANONCE = ANONCE
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    EAPOL = EAPOL (SNONCE is in here)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    MESSAGEPAIR = Bitmask:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    0: MP info (https://hashcat.net/wiki/doku.php?id=hccapx)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    1: MP info (https://hashcat.net/wiki/doku.php?id=hccapx)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    2: MP info (https://hashcat.net/wiki/doku.php?id=hccapx)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    3: x (unused)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    4: ap-less attack (set to 1) - no nonce-error-corrections necessary
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    5: LE router detected (set to 1) - nonce-error-corrections only for LE necessary
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    6: BE router detected (set to 1) - nonce-error-corrections only for BE necessary
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    7: not replaycount checked (set to 1) - replaycount not checked, nonce-error-corrections definitely necessary
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Construct hashcat 22000 format string</span>
</span></span><span style=display:flex><span>    protocol <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;WPA&#34;</span>
</span></span><span style=display:flex><span>    pmkid_mic <span style=color:#f92672>=</span> keymic<span style=color:#f92672>.</span>hex()
</span></span><span style=display:flex><span>    type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;02&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> keyver <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>Exception</span>(<span style=color:#e6db74>&#34;version 2 file not supported&#34;</span>)
</span></span><span style=display:flex><span>    mac_ap_hex <span style=color:#f92672>=</span> mac_ap<span style=color:#f92672>.</span>hex()
</span></span><span style=display:flex><span>    mac_client_hex <span style=color:#f92672>=</span> mac_sta<span style=color:#f92672>.</span>hex()
</span></span><span style=display:flex><span>    essid_hex <span style=color:#f92672>=</span> essid<span style=color:#f92672>.</span>hex()
</span></span><span style=display:flex><span>    nonce_ap_hex <span style=color:#f92672>=</span> nonce_ap<span style=color:#f92672>.</span>hex()
</span></span><span style=display:flex><span>    eapol_hex <span style=color:#f92672>=</span> eapol<span style=color:#f92672>.</span>hex()
</span></span><span style=display:flex><span>    message_pair_hex <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>message_pair<span style=color:#e6db74>:</span><span style=color:#e6db74>02x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    hc22000 <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>protocol<span style=color:#e6db74>}</span><span style=color:#e6db74>*</span><span style=color:#e6db74>{</span>type<span style=color:#e6db74>}</span><span style=color:#e6db74>*</span><span style=color:#e6db74>{</span>pmkid_mic<span style=color:#e6db74>}</span><span style=color:#e6db74>*</span><span style=color:#e6db74>{</span>mac_ap_hex<span style=color:#e6db74>}</span><span style=color:#e6db74>*</span><span style=color:#e6db74>{</span>mac_client_hex<span style=color:#e6db74>}</span><span style=color:#e6db74>*</span><span style=color:#e6db74>{</span>essid_hex<span style=color:#e6db74>}</span><span style=color:#e6db74>*</span><span style=color:#e6db74>{</span>nonce_ap_hex<span style=color:#e6db74>}</span><span style=color:#e6db74>*</span><span style=color:#e6db74>{</span>eapol_hex<span style=color:#e6db74>}</span><span style=color:#e6db74>*</span><span style=color:#e6db74>{</span>message_pair_hex<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    print(hc22000)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>change_extension</span>(inputfile, new_extension<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;.hc22000&#34;</span>):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        更改文件的后缀名
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        :param inputfile: 输入文件的路径
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        :param new_extension: 新的后缀名（例如 &#34;.txt&#34;, &#34;.csv&#34;）
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        :return: 返回新的文件名
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 获取文件名（不含路径）和目录</span>
</span></span><span style=display:flex><span>        base_name <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>basename(inputfile)  <span style=color:#75715e># 获取文件名（含后缀）</span>
</span></span><span style=display:flex><span>        dir_name <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>dirname(inputfile)    <span style=color:#75715e># 获取目录路径</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 分离文件名和后缀</span>
</span></span><span style=display:flex><span>        name, _ <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>splitext(base_name)    <span style=color:#75715e># 分离文件名和后缀</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 构建新的文件名</span>
</span></span><span style=display:flex><span>        new_filename <span style=color:#f92672>=</span> name <span style=color:#f92672>+</span> new_extension
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 如果目录不为空，拼接目录和新的文件名</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> dir_name:
</span></span><span style=display:flex><span>            new_filepath <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(dir_name, new_filename)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            new_filepath <span style=color:#f92672>=</span> new_filename
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> new_filepath
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    outputfile <span style=color:#f92672>=</span> change_extension(input_file)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(outputfile, <span style=color:#e6db74>&#39;w&#39;</span>) <span style=color:#66d9ef>as</span> outfile:
</span></span><span style=display:flex><span>            outfile<span style=color:#f92672>.</span>writelines(hc22000)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></div><p>顺便附带两条常用的掩码模式破解语句</p><p><strong>8位小写字母</strong></p><p><code>hashcat -a 3 -m 22000 dNKc.hc22000 ?l?l?l?l?l?l?l?l -o dump.txt</code></p><p><strong>8位小写字母数字混合</strong></p><p><code>hashcat -a 3 -m 22000 dNKc.hc22000 -1 ?l?d ?1?1?1?1?1?1?1?1 -o dump.txt</code></p><p>ref : <a href="https://hashcat.net/wiki/doku.php?id=hccapx">https://hashcat.net/wiki/doku.php?id=hccapx</a></p><p>ref : <a href="https://hashcat.net/wiki/doku.php?id=cracking_wpawpa2#expected_file_format">https://hashcat.net/wiki/doku.php?id=cracking_wpawpa2#expected_file_format</a></p><p>ref : <a href=https://hashcat.net/forum/thread-10253.html>https://hashcat.net/forum/thread-10253.html</a></p><p>ref : <a href=https://hashcat.net/forum/thread-11417.html>https://hashcat.net/forum/thread-11417.html</a></p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://blog.badend.cn/>End</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a>
<a href=https://beian.miit.gov.cn/ target=_blank>闽ICP备2024054037号-1</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>